## Summary
AutoHelpDesk compares system-wide exploit mitigations and application-specific Attack Surface Reduction (ASR) policy against the customer baseline, because missing hardening lets commodity phishing or drive-by attacks weaponize Office, browser, or PDF payloads with far less effort.

## Signals to Collect
- `Get-ProcessMitigation -System` — capture CFG, DEP, mandatory ASLR, and related global switches for comparison with the baseline template.
- `Get-ProcessMitigation -Name WINWORD.EXE,EXCEL.EXE,POWERPNT.EXE,OUTLOOK.EXE,CHROME.EXE,MSEDGE.EXE,ACROBAT.EXE` — enumerate per-application mitigations for Microsoft Office, Chromium-based browsers, and Adobe Reader, which must align with the hardened profile.
- `Get-MpPreference` — inventory Attack Surface Reduction rule GUIDs and states to confirm each required rule is present and enabled.

## Detection Rule
1. Normalize the system mitigation payload and compare CFG, DEP, ASLR, and other required fields against the reference XML/JSON baseline.
2. Review the per-application mitigation block for each monitored executable and note any deviation from the baseline (missing or disabled flags, absent entries).
3. Parse `AttackSurfaceReductionRules_Ids` and `AttackSurfaceReductionRules_Actions` from `Get-MpPreference`, map each GUID to the baseline requirement, and flag rules that are missing or set to `Disabled`.
4. Produce findings:
   - **ASRRulesDisabled** (High severity): trigger when any mandatory ASR rule GUID is absent from the payload or its action resolves to Disabled/Audit/NotConfigured.
   - **MitigationGaps** (Medium severity): trigger when required system or per-application mitigations are missing, disabled, or unspecified relative to the baseline.
5. Emit a Normal/Informational card when all checks match the baseline and capture the effective configuration as evidence.
6. Surface an Unknown card with collector error details if the PowerShell commands fail or return incomplete data.

## Heuristic Mapping
- `Security/ExploitGuard/ASRRulesDisabled`
- `Security/ExploitGuard/MitigationGaps`

## Remediation
1. Reapply the organization’s exploit protection baseline (XML/JSON) using `Set-ProcessMitigation -System` and `Import-ProcessMitigation` (or equivalent MEM/GPO deployment) to restore missing system and per-app safeguards.
2. Enforce the mandatory ASR rule set for Microsoft Office, Chromium browsers, and Adobe Acrobat by updating Microsoft Defender policies (Intune, GPO, or PowerShell `Set-MpPreference`).
3. Verify policy enforcement by re-running the collection commands and reviewing Defender operational logs for policy application events.
4. Communicate remediation steps to end users, then reboot or restart affected applications to ensure the mitigations take effect before closing the ticket.
