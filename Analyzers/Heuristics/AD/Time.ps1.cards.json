{
  "cards": [
    {
      "card_id": "AD/Time/domain-time-misconfigured-manual-ntp-so-active-directory-cannot-control-system-time",
      "title": "Domain time misconfigured (manual NTP), so Active Directory cannot control system time.",
      "severity": "medium",
      "area": "AD/Time",
      "category": "AD",
      "subcategory": "Time Synchronization",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/AD/Time.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "AD/Time/domain-time-misconfigured-manual-ntp-so-active-directory-cannot-control-system-time",
        "tags": []
      },
      "explanation": "This card indicates 'Domain time misconfigured (manual NTP), so Active Directory cannot control system time.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "($evidencePieces -join '; ')",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Domain time misconfigured (manual NTP), so Active Directory cannot control system time.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Time source or sync failure",
            "steps": [
              "Query Windows Time status and configuration.",
              "Use domain hierarchy (NT5DS) for domain-joined.",
              "Resync and verify offset and Kerberos."
            ],
            "scripts": [
              {
                "name": "Reset time sync",
                "language": "powershell",
                "elevation_required": true,
                "code": "w32tm /query /status\nw32tm /query /configuration\nw32tm /config /syncfromflags:DOMHIER /update\nnet stop w32time\nnet start w32time\nw32tm /resync /force"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "AD/Time/kerberos-time-skew-breaking-active-directory-authentication",
      "title": "Kerberos time skew, breaking Active Directory authentication.",
      "severity": "high",
      "area": "AD/Time",
      "category": "AD",
      "subcategory": "Time Synchronization",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/AD/Time.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "AD/Time/kerberos-time-skew-breaking-active-directory-authentication",
        "tags": []
      },
      "explanation": "This card indicates 'Kerberos time skew, breaking Active Directory authentication.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "(\"Offset {0} seconds\" -f [math]::Round([double]$offset, 2)",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Kerberos time skew, breaking Active Directory authentication.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Time source or sync failure",
            "steps": [
              "Query Windows Time status and configuration.",
              "Use domain hierarchy (NT5DS) for domain-joined.",
              "Resync and verify offset and Kerberos."
            ],
            "scripts": [
              {
                "name": "Reset time sync",
                "language": "powershell",
                "elevation_required": true,
                "code": "w32tm /query /status\nw32tm /query /configuration\nw32tm /config /syncfromflags:DOMHIER /update\nnet stop w32time\nnet start w32time\nw32tm /resync /force"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "AD/Time/kerberos-time-skew-breaking-active-directory-authentication",
      "title": "Kerberos time skew, breaking Active Directory authentication.",
      "severity": "high",
      "area": "AD/Time",
      "category": "AD",
      "subcategory": "Time Synchronization",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/AD/Time.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "AD/Time/kerberos-time-skew-breaking-active-directory-authentication",
        "tags": []
      },
      "explanation": "This card indicates 'Kerberos time skew, breaking Active Directory authentication.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "Time service not synchronized.",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Kerberos time skew, breaking Active Directory authentication.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Time source or sync failure",
            "steps": [
              "Query Windows Time status and configuration.",
              "Use domain hierarchy (NT5DS) for domain-joined.",
              "Resync and verify offset and Kerberos."
            ],
            "scripts": [
              {
                "name": "Reset time sync",
                "language": "powershell",
                "elevation_required": true,
                "code": "w32tm /query /status\nw32tm /query /configuration\nw32tm /config /syncfromflags:DOMHIER /update\nnet stop w32time\nnet start w32time\nw32tm /resync /force"
              }
            ]
          }
        ]
      }
    }
  ]
}
