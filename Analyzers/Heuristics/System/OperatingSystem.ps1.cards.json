{
  "cards": [
    {
      "card_id": "System/OperatingSystem/secure-boot-reported-unexpected-state-0-so-firmware-integrity-protections-may-be-unreliable-f-securebootstate",
      "title": "(\"Secure Boot reported unexpected state '{0}', so firmware integrity protections may be unreliable.\" -f $secureBootState)",
      "severity": "high",
      "area": "System/OperatingSystem",
      "category": "System",
      "subcategory": "Firmware",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/System/OperatingSystem.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "System/OperatingSystem/secure-boot-reported-unexpected-state-0-so-firmware-integrity-protections-may-be-unreliable-f-securebootstate",
        "tags": []
      },
      "explanation": "This card indicates '(\"Secure Boot reported unexpected state '{0}', so firmware integrity protections may be unreliable.\" -f $secureBootState)'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$secureBootEvidence",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates '(\"Secure Boot reported unexpected state '{0}', so firmware integrity protections may be unreliable.\" -f $secureBootState)'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Firewall/network ACLs blocking ports",
            "steps": [
              "Identify failing ports from evidence.",
              "Enable profiles and allow required ports."
            ],
            "scripts": [
              {
                "name": "Enable profiles & test",
                "language": "powershell",
                "elevation_required": true,
                "code": "Set-NetFirewallProfile -Profile Domain,Private,Public -Enabled True\n$ports=@(88,135,389,445,53)\nforeach($p in $ports){ Test-NetConnection -ComputerName localhost -Port $p | Select RemotePort,TcpTestSucceeded }"
              }
            ]
          },
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "System/OperatingSystem/operating-system-inventory-not-available",
      "title": "Operating system inventory not available",
      "severity": "info",
      "area": "System/OperatingSystem",
      "category": "System",
      "subcategory": "Operating System",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/System/OperatingSystem.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "System/OperatingSystem/operating-system-inventory-not-available",
        "tags": []
      },
      "explanation": "This card indicates 'Operating system inventory not available'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Operating system inventory not available'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Generic misconfiguration",
            "steps": [
              "Use Evidence to target failing component; review services, logs, and policies."
            ],
            "scripts": []
          }
        ]
      }
    },
    {
      "card_id": "System/OperatingSystem/operating-system-unsupported",
      "title": "Operating system unsupported",
      "severity": "critical",
      "area": "System/OperatingSystem",
      "category": "System",
      "subcategory": "Operating System",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/System/OperatingSystem.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "System/OperatingSystem/operating-system-unsupported",
        "tags": []
      },
      "explanation": "This card indicates 'Operating system unsupported'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$evidence",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Operating system unsupported'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Firewall/network ACLs blocking ports",
            "steps": [
              "Identify failing ports from evidence.",
              "Enable profiles and allow required ports."
            ],
            "scripts": [
              {
                "name": "Enable profiles & test",
                "language": "powershell",
                "elevation_required": true,
                "code": "Set-NetFirewallProfile -Profile Domain,Private,Public -Enabled True\n$ports=@(88,135,389,445,53)\nforeach($p in $ports){ Test-NetConnection -ComputerName localhost -Port $p | Select RemotePort,TcpTestSucceeded }"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "System/OperatingSystem/secure-boot-is-disabled-so-the-device-can-boot-untrusted-firmware",
      "title": "Secure Boot is disabled, so the device can boot untrusted firmware.",
      "severity": "high",
      "area": "System/OperatingSystem",
      "category": "System",
      "subcategory": "Firmware",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/System/OperatingSystem.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "System/OperatingSystem/secure-boot-is-disabled-so-the-device-can-boot-untrusted-firmware",
        "tags": []
      },
      "explanation": "This card indicates 'Secure Boot is disabled, so the device can boot untrusted firmware.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$secureBootEvidence",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Secure Boot is disabled, so the device can boot untrusted firmware.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "System/OperatingSystem/secure-boot-is-unsupported-on-this-hardware-so-firmware-integrity-protections-cannot-run",
      "title": "Secure Boot is unsupported on this hardware, so firmware integrity protections cannot run.",
      "severity": "high",
      "area": "System/OperatingSystem",
      "category": "System",
      "subcategory": "Firmware",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/System/OperatingSystem.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "System/OperatingSystem/secure-boot-is-unsupported-on-this-hardware-so-firmware-integrity-protections-cannot-run",
        "tags": []
      },
      "explanation": "This card indicates 'Secure Boot is unsupported on this hardware, so firmware integrity protections cannot run.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$secureBootEvidence",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Secure Boot is unsupported on this hardware, so firmware integrity protections cannot run.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Firewall/network ACLs blocking ports",
            "steps": [
              "Identify failing ports from evidence.",
              "Enable profiles and allow required ports."
            ],
            "scripts": [
              {
                "name": "Enable profiles & test",
                "language": "powershell",
                "elevation_required": true,
                "code": "Set-NetFirewallProfile -Profile Domain,Private,Public -Enabled True\n$ports=@(88,135,389,445,53)\nforeach($p in $ports){ Test-NetConnection -ComputerName localhost -Port $p | Select RemotePort,TcpTestSucceeded }"
              }
            ]
          },
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "System/OperatingSystem/secure-boot-state-not-reported-despite-uefi-firmware-so-the-device-may-boot-without-firmware-integrity-protections",
      "title": "Secure Boot state not reported despite UEFI firmware, so the device may boot without firmware integrity protections.",
      "severity": "high",
      "area": "System/OperatingSystem",
      "category": "System",
      "subcategory": "Firmware",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/System/OperatingSystem.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "System/OperatingSystem/secure-boot-state-not-reported-despite-uefi-firmware-so-the-device-may-boot-without-firmware-integrity-protections",
        "tags": []
      },
      "explanation": "This card indicates 'Secure Boot state not reported despite UEFI firmware, so the device may boot without firmware integrity protections.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "(($evidence | Where-Object { $_ })",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Secure Boot state not reported despite UEFI firmware, so the device may boot without firmware integrity protections.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Firewall/network ACLs blocking ports",
            "steps": [
              "Identify failing ports from evidence.",
              "Enable profiles and allow required ports."
            ],
            "scripts": [
              {
                "name": "Enable profiles & test",
                "language": "powershell",
                "elevation_required": true,
                "code": "Set-NetFirewallProfile -Profile Domain,Private,Public -Enabled True\n$ports=@(88,135,389,445,53)\nforeach($p in $ports){ Test-NetConnection -ComputerName localhost -Port $p | Select RemotePort,TcpTestSucceeded }"
              }
            ]
          },
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "System/OperatingSystem/system-inventory-artifact-missing",
      "title": "System inventory artifact missing",
      "severity": "info",
      "area": "System/OperatingSystem",
      "category": "System",
      "subcategory": "Collection",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/System/OperatingSystem.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "System/OperatingSystem/system-inventory-artifact-missing",
        "tags": []
      },
      "explanation": "This card indicates 'System inventory artifact missing'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'System inventory artifact missing'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Generic misconfiguration",
            "steps": [
              "Use Evidence to target failing component; review services, logs, and policies."
            ],
            "scripts": []
          }
        ]
      }
    },
    {
      "card_id": "System/OperatingSystem/unable-to-query-computer-system-details",
      "title": "Unable to query computer system details",
      "severity": "info",
      "area": "System/OperatingSystem",
      "category": "System",
      "subcategory": "Hardware Inventory",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/System/OperatingSystem.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "System/OperatingSystem/unable-to-query-computer-system-details",
        "tags": []
      },
      "explanation": "This card indicates 'Unable to query computer system details'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$payload.ComputerSystem.Error",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Unable to query computer system details'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Generic misconfiguration",
            "steps": [
              "Use Evidence to target failing component; review services, logs, and policies."
            ],
            "scripts": []
          }
        ]
      }
    },
    {
      "card_id": "System/OperatingSystem/unable-to-read-os-inventory",
      "title": "Unable to read OS inventory",
      "severity": "info",
      "area": "System/OperatingSystem",
      "category": "System",
      "subcategory": "Operating System",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/System/OperatingSystem.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "System/OperatingSystem/unable-to-read-os-inventory",
        "tags": []
      },
      "explanation": "This card indicates 'Unable to read OS inventory'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "($payload.OperatingSystem.Error)",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Unable to read OS inventory'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Generic misconfiguration",
            "steps": [
              "Use Evidence to target failing component; review services, logs, and policies."
            ],
            "scripts": []
          }
        ]
      }
    }
  ]
}
