{
  "cards": [
    {
      "card_id": "Security/DeviceProtection/asr-rule-not-enforced-0-leaving-exploit-paths-open-f-set-label",
      "title": "(\"ASR rule not enforced: {0}, leaving exploit paths open.\" -f $set.Label)",
      "severity": "high",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Attack Surface Reduction",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/asr-rule-not-enforced-0-leaving-exploit-paths-open-f-set-label",
        "tags": []
      },
      "explanation": "This card indicates '(\"ASR rule not enforced: {0}, leaving exploit paths open.\" -f $set.Label)'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "($evidenceLines -join \"`n\")",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates '(\"ASR rule not enforced: {0}, leaving exploit paths open.\" -f $set.Label)'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/tpm-spec-version-0-reported-so-modern-key-protection-features-that-require-tpm-2-0-are-unavailable-f-specversiontext",
      "title": "(\"TPM spec version {0} reported, so modern key protection features that require TPM 2.0 are unavailable.\" -f $specVersionText)",
      "severity": "high",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "TPM",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/tpm-spec-version-0-reported-so-modern-key-protection-features-that-require-tpm-2-0-are-unavailable-f-specversiontext",
        "tags": []
      },
      "explanation": "This card indicates '(\"TPM spec version {0} reported, so modern key protection features that require TPM 2.0 are unavailable.\" -f $specVersionText)'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "(\"Get-Tpm reported SpecVersion = {0}.\" -f $specVersionText)",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates '(\"TPM spec version {0} reported, so modern key protection features that require TPM 2.0 are unavailable.\" -f $specVersionText)'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Firewall/network ACLs blocking ports",
            "steps": [
              "Identify failing ports from evidence.",
              "Enable profiles and allow required ports."
            ],
            "scripts": [
              {
                "name": "Enable profiles & test",
                "language": "powershell",
                "elevation_required": true,
                "code": "Set-NetFirewallProfile -Profile Domain,Private,Public -Enabled True\n$ports=@(88,135,389,445,53)\nforeach($p in $ports){ Test-NetConnection -ComputerName localhost -Port $p | Select RemotePort,TcpTestSucceeded }"
              }
            ]
          },
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/exploit-protection-mitigations-not-fully-enabled-0",
      "title": "('Exploit protection mitigations not fully enabled ({0})",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Exploit Protection",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/exploit-protection-mitigations-not-fully-enabled-0",
        "tags": []
      },
      "explanation": "This card indicates '('Exploit protection mitigations not fully enabled ({0})'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$evidenceText",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates '('Exploit protection mitigations not fully enabled ({0})'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/asr-policy-data-missing-leaving-exploit-paths-open",
      "title": "ASR policy data missing, leaving exploit paths open.",
      "severity": "high",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Attack Surface Reduction",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/asr-policy-data-missing-leaving-exploit-paths-open",
        "tags": []
      },
      "explanation": "This card indicates 'ASR policy data missing, leaving exploit paths open.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'ASR policy data missing, leaving exploit paths open.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/asr-policy-data-missing-leaving-exploit-paths-open",
      "title": "ASR policy data missing, leaving exploit paths open.",
      "severity": "high",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Attack Surface Reduction",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/asr-policy-data-missing-leaving-exploit-paths-open",
        "tags": []
      },
      "explanation": "This card indicates 'ASR policy data missing, leaving exploit paths open.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'ASR policy data missing, leaving exploit paths open.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/exploit-protection-not-captured-so-exploit-resistance-is-unknown",
      "title": "Exploit Protection not captured, so exploit resistance is unknown.",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Exploit Protection",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/exploit-protection-not-captured-so-exploit-resistance-is-unknown",
        "tags": []
      },
      "explanation": "This card indicates 'Exploit Protection not captured, so exploit resistance is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$payload.Mitigations.Error",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Exploit Protection not captured, so exploit resistance is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/exploit-protection-not-captured-so-exploit-resistance-is-unknown",
      "title": "Exploit Protection not captured, so exploit resistance is unknown.",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Exploit Protection",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/exploit-protection-not-captured-so-exploit-resistance-is-unknown",
        "tags": []
      },
      "explanation": "This card indicates 'Exploit Protection not captured, so exploit resistance is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Exploit Protection not captured, so exploit resistance is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/exploit-protection-not-captured-so-exploit-resistance-is-unknown",
      "title": "Exploit Protection not captured, so exploit resistance is unknown.",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Exploit Protection",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/exploit-protection-not-captured-so-exploit-resistance-is-unknown",
        "tags": []
      },
      "explanation": "This card indicates 'Exploit Protection not captured, so exploit resistance is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Exploit Protection not captured, so exploit resistance is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/kernel-dma-protection-allows-dma-while-locked-on-this-device-allowdmaunderlock-1-enabling-dma-attacks-via-peripherals",
      "title": "Kernel DMA protection allows DMA while locked on this device (AllowDmaUnderLock = 1), enabling DMA attacks via peripherals.",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Kernel DMA",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/kernel-dma-protection-allows-dma-while-locked-on-this-device-allowdmaunderlock-1-enabling-dma-attacks-via-peripherals",
        "tags": []
      },
      "explanation": "This card indicates 'Kernel DMA protection allows DMA while locked on this device (AllowDmaUnderLock = 1), enabling DMA attacks via peripherals.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$dmaEvidence",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Kernel DMA protection allows DMA while locked on this device (AllowDmaUnderLock = 1), enabling DMA attacks via peripherals.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/kernel-dma-protection-unknown-leaving-potential-dma-attacks-via-peripherals-unchecked",
      "title": "Kernel DMA protection unknown, leaving potential DMA attacks via peripherals unchecked.",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Kernel DMA",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/kernel-dma-protection-unknown-leaving-potential-dma-attacks-via-peripherals-unchecked",
        "tags": []
      },
      "explanation": "This card indicates 'Kernel DMA protection unknown, leaving potential DMA attacks via peripherals unchecked.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$dmaEvidence",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Kernel DMA protection unknown, leaving potential DMA attacks via peripherals unchecked.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/kernel-dma-protection-unknown-leaving-potential-dma-attacks-via-peripherals-unchecked",
      "title": "Kernel DMA protection unknown, leaving potential DMA attacks via peripherals unchecked.",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Kernel DMA",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/kernel-dma-protection-unknown-leaving-potential-dma-attacks-via-peripherals-unchecked",
        "tags": []
      },
      "explanation": "This card indicates 'Kernel DMA protection unknown, leaving potential DMA attacks via peripherals unchecked.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Kernel DMA protection unknown, leaving potential DMA attacks via peripherals unchecked.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/no-tpm-detected-so-hardware-based-key-protection-is-unavailable",
      "title": "No TPM detected, so hardware-based key protection is unavailable.",
      "severity": "high",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "TPM",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/no-tpm-detected-so-hardware-based-key-protection-is-unavailable",
        "tags": []
      },
      "explanation": "This card indicates 'No TPM detected, so hardware-based key protection is unavailable.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "Get-Tpm reported TpmPresent = False.",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'No TPM detected, so hardware-based key protection is unavailable.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/no-wdac-policy-enforcement-detected-so-unrestricted-code-execution-remains-possible",
      "title": "No WDAC policy enforcement detected, so unrestricted code execution remains possible.",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Windows Defender Application Control",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/no-wdac-policy-enforcement-detected-so-unrestricted-code-execution-remains-possible",
        "tags": []
      },
      "explanation": "This card indicates 'No WDAC policy enforcement detected, so unrestricted code execution remains possible.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "($wdacEvidenceLines -join \"`n\")",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'No WDAC policy enforcement detected, so unrestricted code execution remains possible.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/smart-app-control-disabled-so-app-trust-enforcement-is-reduced",
      "title": "Smart App Control disabled, so app trust enforcement is reduced.",
      "severity": "info",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Smart App Control",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/smart-app-control-disabled-so-app-trust-enforcement-is-reduced",
        "tags": []
      },
      "explanation": "This card indicates 'Smart App Control disabled, so app trust enforcement is reduced.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$evidenceText",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Smart App Control disabled, so app trust enforcement is reduced.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Disk issues or low space",
            "steps": [
              "Back up data; clean temp; evaluate SMART."
            ],
            "scripts": [
              {
                "name": "Cleanup",
                "language": "powershell",
                "elevation_required": true,
                "code": "$paths=@($env:TEMP,'C:\\Windows\\Temp')\nforeach($p in $paths){ Get-ChildItem $p -Recurse -Force -ErrorAction SilentlyContinue | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue }\nDism.exe /online /Cleanup-Image /StartComponentCleanup /ResetBase"
              }
            ]
          },
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/smart-app-control-in-evaluation-mode-so-app-trust-enforcement-is-reduced",
      "title": "Smart App Control in evaluation mode, so app trust enforcement is reduced.",
      "severity": "$severity",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Smart App Control",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/smart-app-control-in-evaluation-mode-so-app-trust-enforcement-is-reduced",
        "tags": []
      },
      "explanation": "This card indicates 'Smart App Control in evaluation mode, so app trust enforcement is reduced.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$evidenceText",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Smart App Control in evaluation mode, so app trust enforcement is reduced.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Disk issues or low space",
            "steps": [
              "Back up data; clean temp; evaluate SMART."
            ],
            "scripts": [
              {
                "name": "Cleanup",
                "language": "powershell",
                "elevation_required": true,
                "code": "$paths=@($env:TEMP,'C:\\Windows\\Temp')\nforeach($p in $paths){ Get-ChildItem $p -Recurse -Force -ErrorAction SilentlyContinue | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue }\nDism.exe /online /Cleanup-Image /StartComponentCleanup /ResetBase"
              }
            ]
          },
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/smart-app-control-is-not-enabled-on-windows-11-device-so-app-trust-enforcement-is-reduced",
      "title": "Smart App Control is not enabled on Windows 11 device, so app trust enforcement is reduced.",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Smart App Control",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/smart-app-control-is-not-enabled-on-windows-11-device-so-app-trust-enforcement-is-reduced",
        "tags": []
      },
      "explanation": "This card indicates 'Smart App Control is not enabled on Windows 11 device, so app trust enforcement is reduced.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$evidenceText",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Smart App Control is not enabled on Windows 11 device, so app trust enforcement is reduced.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Disk issues or low space",
            "steps": [
              "Back up data; clean temp; evaluate SMART."
            ],
            "scripts": [
              {
                "name": "Cleanup",
                "language": "powershell",
                "elevation_required": true,
                "code": "$paths=@($env:TEMP,'C:\\Windows\\Temp')\nforeach($p in $paths){ Get-ChildItem $p -Recurse -Force -ErrorAction SilentlyContinue | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue }\nDism.exe /online /Cleanup-Image /StartComponentCleanup /ResetBase"
              }
            ]
          },
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/tpm-not-initialized-so-hardware-based-key-protection-is-unavailable",
      "title": "TPM not initialized, so hardware-based key protection is unavailable.",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "TPM",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/tpm-not-initialized-so-hardware-based-key-protection-is-unavailable",
        "tags": []
      },
      "explanation": "This card indicates 'TPM not initialized, so hardware-based key protection is unavailable.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "Get-Tpm reported TpmReady = False.",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'TPM not initialized, so hardware-based key protection is unavailable.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/unable-to-query-smart-app-control-state-so-app-trust-enforcement-is-unknown",
      "title": "Unable to query Smart App Control state, so app trust enforcement is unknown.",
      "severity": "info",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Smart App Control",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/unable-to-query-smart-app-control-state-so-app-trust-enforcement-is-unknown",
        "tags": []
      },
      "explanation": "This card indicates 'Unable to query Smart App Control state, so app trust enforcement is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$entry.Error",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Unable to query Smart App Control state, so app trust enforcement is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Disk issues or low space",
            "steps": [
              "Back up data; clean temp; evaluate SMART."
            ],
            "scripts": [
              {
                "name": "Cleanup",
                "language": "powershell",
                "elevation_required": true,
                "code": "$paths=@($env:TEMP,'C:\\Windows\\Temp')\nforeach($p in $paths){ Get-ChildItem $p -Recurse -Force -ErrorAction SilentlyContinue | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue }\nDism.exe /online /Cleanup-Image /StartComponentCleanup /ResetBase"
              }
            ]
          },
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/unable-to-query-tpm-status-so-hardware-based-key-protection-availability-is-unknown",
      "title": "Unable to query TPM status, so hardware-based key protection availability is unknown.",
      "severity": "medium",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "TPM",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/unable-to-query-tpm-status-so-hardware-based-key-protection-availability-is-unknown",
        "tags": []
      },
      "explanation": "This card indicates 'Unable to query TPM status, so hardware-based key protection availability is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "$payload.Tpm.Error",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'Unable to query TPM status, so hardware-based key protection availability is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    },
    {
      "card_id": "Security/DeviceProtection/wdac-smart-app-control-diagnostics-not-collected-so-app-trust-enforcement-is-unknown",
      "title": "WDAC/Smart App Control diagnostics not collected, so app trust enforcement is unknown.",
      "severity": "info",
      "area": "Security/DeviceProtection",
      "category": "Security",
      "subcategory": "Smart App Control",
      "paths": {
        "analyzer_file": "Analyzers/Heuristics/Security/Security.DeviceProtection.ps1",
        "composer_file": "Analyzers/HtmlComposer.ps1",
        "collector_files": [],
        "function": null
      },
      "meta": {
        "check_id": "Security/DeviceProtection/wdac-smart-app-control-diagnostics-not-collected-so-app-trust-enforcement-is-unknown",
        "tags": []
      },
      "explanation": "This card indicates 'WDAC/Smart App Control diagnostics not collected, so app trust enforcement is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
      "evidence": "",
      "raw_payload": "",
      "troubleshooting": {
        "overview": "This card indicates 'WDAC/Smart App Control diagnostics not collected, so app trust enforcement is unknown.'. Investigate configuration, service state, permissions, and recent changes impacting this area.",
        "scenarios": [
          {
            "title": "Potential Issue – Disk issues or low space",
            "steps": [
              "Back up data; clean temp; evaluate SMART."
            ],
            "scripts": [
              {
                "name": "Cleanup",
                "language": "powershell",
                "elevation_required": true,
                "code": "$paths=@($env:TEMP,'C:\\Windows\\Temp')\nforeach($p in $paths){ Get-ChildItem $p -Recurse -Force -ErrorAction SilentlyContinue | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue }\nDism.exe /online /Cleanup-Image /StartComponentCleanup /ResetBase"
              }
            ]
          },
          {
            "title": "Potential Issue – Secure Boot off",
            "steps": [
              "Check UEFI and Secure Boot support; plan migration."
            ],
            "scripts": [
              {
                "name": "Check state",
                "language": "powershell",
                "elevation_required": false,
                "code": "Confirm-SecureBootUEFI\n(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State' -ErrorAction SilentlyContinue).UEFISecureBootEnabled"
              }
            ]
          }
        ]
      }
    }
  ]
}
